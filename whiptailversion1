#!/bin/bash
#Personal Budgeting System

balance=0
expenses=0

display_menu(){
    echo "Personal Budgeting System"

    balance=0.00
    expenses=0.00

    display_menu(){
      CHOICE=$(whiptail --clear --title "Personal Budgeting System" --menu "Choose an option:" 15 60 4 \
        "1" "View Balance" \
        "2" "Add Income" \
        "3" "Add Expense" \
        "4" "Quit" 3>&1 1>&2 2>&3)
      echo "$CHOICE"
    }

    is_number() {
      [[ $1 =~ ^[0-9]+([.][0-9]+)?$ ]]
    }

    add_expense() {
      amount=$(whiptail --inputbox "Enter the expense amount:" 8 50 3>&1 1>&2 2>&3)
      ret=$?
      if [ $ret -ne 0 ]; then
        return
      fi
      if is_number "$amount"; then
        expenses=$(awk "BEGIN{printf \"%.2f\", $expenses + $amount}")
        balance=$(awk "BEGIN{printf \"%.2f\", $balance - $amount}")
        whiptail --msgbox "Expense added successfully." 6 50
      else
        whiptail --msgbox "Invalid amount. Please enter a positive number." 6 50
      fi
    }

    add_income(){
      amount=$(whiptail --inputbox "Enter your income amount:" 8 50 3>&1 1>&2 2>&3)
      ret=$?
      if [ $ret -ne 0 ]; then
        return
      fi
      if is_number "$amount"; then
        balance=$(awk "BEGIN{printf \"%.2f\", $balance + $amount}")
        whiptail --msgbox "Income added successfully." 6 50
      else
        whiptail --msgbox "Invalid amount. Please enter a positive number." 6 50
      fi
    }

    while true; do
      choice=$(display_menu)
      case $choice in
        1)
          whiptail --msgbox "Current Balance: $balance\nTotal Expenses: $expenses" 8 60
          ;;
        2)
          add_income
          ;;
        3)
          add_expense
          ;;
        4)
          whiptail --msgbox "Goodbye!" 6 40
          clear
          exit 0
          ;;
        *)
          whiptail --msgbox "Invalid choice. Please select a valid option." 6 50
          ;;
      esac
    done
